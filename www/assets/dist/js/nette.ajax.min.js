"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};
/**
 * AJAX Nette Framework plugin for jQuery
 *
 * @copyright Copyright (c) 2009, 2010 Jan Marek
 * @copyright Copyright (c) 2009, 2010 David Grudl
 * @copyright Copyright (c) 2012-2014 Vojtěch Dobeš
 * @license MIT
 *
 * @version 2.3.0
 */!function(t,e,i){if("function"!=typeof e)return console.error("nette.ajax.js: jQuery is missing, load it please");e.nette=new(e.extend((function(){var i={self:this,initialized:!1,contexts:{},on:{init:{},load:{},prepare:{},before:{},start:{},success:{},complete:{},error:{}},fire:function(){var t=!0,n=Array.prototype.slice.call(arguments),o=n.shift(),r="string"==typeof o?o:o.name,a="object"===(void 0===o?"undefined":_typeof(o))&&o.off||{};return n.push(i.self),e.each(i.on[r],(function(o,r){if(void 0===r||-1!==e.inArray(o,a))return!0;var f=r.apply(i.contexts[o],n);return t=void 0===f||f})),t},requestHandler:function(t){var e=i.self.ajax({},this,t);if(e&&e._returnFalse)return!1},ext:function(t,n,o){for(;!o;)o="ext_"+Math.random(),i.contexts[o]&&(o=void 0);e.each(t,(function(t,e){i.on[t][o]=e})),i.contexts[o]=e.extend(n||{},{name:function(){return o},ext:function(t,e){var n=i.contexts[t];if(!n&&e)throw"Extension '"+this.name()+"' depends on disabled extension '"+t+"'.";return n}})}};this.ext=function(t,n,o){if("object"===(void 0===t?"undefined":_typeof(t)))i.ext(t,n);else{if(void 0===n)return i.contexts[t];if(n){if("string"==typeof t&&void 0!==i.contexts[t])throw"Cannot override already registered nette-ajax extension '"+t+"'.";i.ext(n,o,t)}else e.each(["init","load","prepare","before","start","success","complete","error"],(function(e,n){i.on[n][t]=void 0})),i.contexts[t]=void 0}return this},this.init=function(t,e){if(i.initialized)throw"Cannot initialize nette-ajax twice.";if("function"==typeof t)this.ext("init",null),this.ext("init",{load:t},e);else if("object"===(void 0===t?"undefined":_typeof(t)))this.ext("init",null),this.ext("init",t,e);else if(void 0!==t)throw"Argument of init() can be function or function-hash only.";return i.initialized=!0,i.fire("init"),this.load(),this},this.load=function(){return i.fire("load",i.requestHandler),this},this.ajax=function(n,o,r){if("string"===e.type(n)&&(n={url:n}),!n.nette&&o&&r){var a,f=e(o),s=n.nette={e:r,ui:o,el:f,isForm:f.is("form"),isSubmit:f.is("input[type=submit]")||f.is("button[type=submit]"),isImage:f.is("input[type=image]"),form:null};if(s.isSubmit||s.isImage?s.form=s.el.closest("form"):s.isForm&&(s.form=s.el),n.url||(n.url=s.form?s.form.attr("action")||t.location.pathname+t.location.search:o.href),n.type||(n.type=s.form?s.form.attr("method"):"get"),f.is("[data-ajax-off]")){var u=f.attr("data-ajax-off");0===u.indexOf("[")?n.off=f.data("ajaxOff"):-1!==u.indexOf(",")?n.off=u.split(","):-1!==u.indexOf(" ")?n.off=u.split(" "):n.off=u,"string"==typeof n.off&&(n.off=[n.off]),n.off=e.grep(e.each(n.off,(function(t){return e.trim(t)})),(function(t){return t.length}))}}return i.fire({name:"prepare",off:n.off||{}},n),n.prepare&&n.prepare(n),a=n.beforeSend,n.beforeSend=function(t,e){var n=i.fire({name:"before",off:e.off||{}},t,e);return(n||void 0===n)&&a&&(n=a(t,e)),n},this.handleXHR(e.ajax(n),n)},this.handleXHR=function(t,e){return e=e||{},!t||void 0!==t.statusText&&"canceled"===t.statusText||(t.done((function(t,n,o){i.fire({name:"success",off:e.off||{}},t,n,o,e)})).fail((function(t,n,o){i.fire({name:"error",off:e.off||{}},t,n,o,e)})).always((function(t,n){i.fire({name:"complete",off:e.off||{}},t,n,e)})),i.fire({name:"start",off:e.off||{}},t,e),e.start&&e.start(t,e)),t}}),e.nette?e.nette:{})),e.fn.netteAjax=function(t,i){return e.nette.ajax(i||{},this[0],t)},e.fn.netteAjaxOff=function(){return this.off(".nette")},e.nette.ext("validation",{before:function(t,i){if(!i.nette)return!0;var n=i.nette,o=n.e,r=e.extend(this.defaults,i.validate||function(){if(n.el.is("[data-ajax-validate]")){var t=n.el.data("ajaxValidate");return!1===t?{keys:!1,url:!1,form:!1}:"object"===(void 0===t?"undefined":_typeof(t))?t:void 0}}()||{}),a=!1;if(void 0!==n.el.attr("data-ajax-pass")&&(a="bool"!=typeof(a=n.el.data("ajaxPass"))||a),r.keys){var f=o.button||o.ctrlKey||o.shiftKey||o.altKey||o.metaKey;if(n.form){if(f&&n.isSubmit)return this.explicitNoAjax=!0,!1;if(n.isForm&&this.explicitNoAjax)return this.explicitNoAjax=!1,!1}else if(f)return!1}if(r.form&&n.form){var s;if((n.isSubmit||n.isImage)&&(n.form.get(0)["nette-submittedBy"]=n.el.get(0)),void 0===Nette.version||"2.3"==Nette.version){var u=this.ie();s=n.form.get(0).onsubmit&&!1===n.form.get(0).onsubmit(void 0!==u&&u<9?void 0:o)}else s=!1===(n.form.get(0).onsubmit?n.form.triggerHandler("submit"):Nette.validateForm(n.form.get(0)));if(s)return o.stopImmediatePropagation(),o.preventDefault(),!1}if(r.url){var l=n.form?i.url:n.el.attr("href");if(/(?:^[a-z][a-z0-9+.-]*:|\/\/)/.test(l)){var c=new URL(l);if(/:|^#/.test(c.pathname+c.search+c.hash))return!1}else if(/:|^#/.test(l))return!1}return a||(o.stopPropagation(),o.preventDefault(),t._returnFalse=!0),!0}},{defaults:{keys:!0,url:!0,form:!0},explicitNoAjax:!1,ie:function(t){for(var e=3,i=document.createElement("div"),n=i.getElementsByTagName("i");i.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",n[0];);return e>4?e:t}}),e.nette.ext("forms",{init:function(){var e;t.Nette&&(e=this.ext("snippets"))&&e.after((function(e){e.find("form").each((function(){t.Nette.initForm(this)}))}))},prepare:function(i){var n=i.nette;if(n&&n.form){var o=n.e,r=i.data||{},a={};if(n.isSubmit)a[n.el.attr("name")]=n.el.val()||"";else if(n.isImage){var f=n.el.offset(),s=n.el.attr("name"),u=[Math.max(0,o.pageX-f.left),Math.max(0,o.pageY-f.top)];-1!==s.indexOf("[",0)?a[s]=u:(a[s+".x"]=u[0],a[s+".y"]=u[1])}var l=n.form.attr("method");if(l&&"post"===l.toLowerCase()&&"FormData"in t){var c=new FormData(n.form[0]);for(var p in a)c.append(p,a[p]);if("string"!=typeof r)for(var p in r)c.append(p,r[p]);if(c.entries&&navigator.userAgent.match(/version\/11(\.[0-9]*)? safari/i)){var d=!0,m=!1,h=void 0;try{for(var x,y=c.entries()[Symbol.iterator]();!(d=(x=y.next()).done);d=!0){var v=x.value;v[1]instanceof File&&""===v[1].name&&0===v[1].size&&c.delete(v[0])}}catch(t){m=!0,h=t}finally{try{!d&&y.return&&y.return()}finally{if(m)throw h}}}i.data=c,i.processData=!1,i.contentType=!1}else"string"!=typeof r&&(r=e.param(r)),a=e.param(a),i.data=n.form.serialize()+(a?"&"+a:"")+"&"+r}}}),e.nette.ext("snippets",{success:function(t){t.snippets&&this.updateSnippets(t.snippets)}},{beforeQueue:e.Callbacks(),afterQueue:e.Callbacks(),completeQueue:e.Callbacks(),before:function(t){this.beforeQueue.add(t)},after:function(t){this.afterQueue.add(t)},complete:function(t){this.completeQueue.add(t)},updateSnippets:function(t,i){var n=this,o=[];for(var r in t){var a=this.getElement(r);a.get(0)&&o.push(a.get(0)),this.updateSnippet(a,t[r],i)}e(o).promise().done((function(){n.completeQueue.fire()}))},updateSnippet:function(t,e,i){t.is("title")?document.title=e:(this.beforeQueue.fire(t),this.applySnippet(t,e,i),this.afterQueue.fire(t))},getElement:function(t){return e("#"+this.escapeSelector(t))},applySnippet:function(t,e,i){!i&&t.is("[data-ajax-append]")?t.append(e):!i&&t.is("[data-ajax-prepend]")?t.prepend(e):(t.html()!=e||/<[^>]*script/.test(e))&&t.html(e)},escapeSelector:function(t){return t.replace(/[\!"#\$%&'\(\)\*\+,\.\/:;<=>\?@\[\\\]\^`\{\|\}~]/g,"\\$&")}}),e.nette.ext("redirect",{success:function(e){if(e.redirect)return t.location.href=e.redirect,!1}}),e.nette.ext("state",{success:function(t){t.state&&(this.state=t.state)}},{state:null}),e.nette.ext("unique",{start:function(t){this.xhr&&this.xhr.abort(),this.xhr=t},complete:function(){this.xhr=null}},{xhr:null}),e.nette.ext("abort",{init:function(){e("body").keydown(e.proxy((function(t){this.xhr&&"27"===t.keyCode.toString()&&!(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)&&this.xhr.abort()}),this))},start:function(t){this.xhr=t},complete:function(){this.xhr=null}},{xhr:null}),e.nette.ext("load",{success:function(){e.nette.load()}}),e.nette.ext("init",{load:function(t){e(this.linkSelector).off("click.nette",t).on("click.nette",t),e(this.formSelector).off("submit.nette",t).on("submit.nette",t).off("click.nette",":image",t).on("click.nette",":image",t).off("click.nette",":submit",t).on("click.nette",":submit",t),e(this.buttonSelector).closest("form").off("click.nette",this.buttonSelector,t).on("click.nette",this.buttonSelector,t)}},{linkSelector:"a.ajax",formSelector:"form.ajax",buttonSelector:'input.ajax[type="submit"], button.ajax[type="submit"], input.ajax[type="image"]'})}(window,window.jQuery);